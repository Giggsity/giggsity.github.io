<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Calculator</title>
    <link rel="stylesheet" type="text/css" href="calculator.css">
    <script src="https://unpkg.com/react@16/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>
    <script type="text/babel">

        class Button extends React.Component {
            render() {
                return (
                    <div id="buttons">
                        <button id="clear"      value="clear"       onClick={this.props.handleFunctionPress}>A/C</button>
                        <button id="sign"       value="sign"        onClick={this.props.handleFunctionPress}>+/-</button>
                        <button id="divide"     value="divide"      onClick={this.props.handleFunctionPress}>&#247;</button>
                        <button id="seven"      value="7"           onClick={this.props.handleNumberPress}>7</button>
                        <button id="eight"      value="8"           onClick={this.props.handleNumberPress}>8</button>
                        <button id="nine"       value="9"           onClick={this.props.handleNumberPress}>9</button>
                        <button id="multiply"   value="multiply"    onClick={this.props.handleFunctionPress}>&#215;</button>
                        <button id="four"       value="4"           onClick={this.props.handleNumberPress}>4</button>
                        <button id="five"       value="5"           onClick={this.props.handleNumberPress}>5</button>
                        <button id="six"        value="6"           onClick={this.props.handleNumberPress}>6</button>
                        <button id="subtract"   value="subtract"    onClick={this.props.handleFunctionPress}>-</button>
                        <button id="one"        value="1"           onClick={this.props.handleNumberPress}>1</button>
                        <button id="two"        value="2"           onClick={this.props.handleNumberPress}>2</button>
                        <button id="three"      value="3"           onClick={this.props.handleNumberPress}>3</button>
                        <button id="add"        value="add"         onClick={this.props.handleFunctionPress}>+</button>
                        <button id="zero"       value="0"           onClick={this.props.handleNumberPress}>0</button>
                        <button id="decimal"    value="decimal"     onClick={this.props.handleNumberPress}>.</button>
                        <button id="equals"     value="equals"      onClick={this.props.handleFunctionPress}>=</button>
                    </div>
            )
            }
        }

        class Display extends React.Component {
            render() {
                return (
                    <div id="display">{this.props.numberDisplayed}
                    </div>
            )
            }
        }

        class Calculator extends React.Component {
            constructor(props) {
                super(props);
                this.state = {
                    numberDisplayed: '0',
                    arithmetic: '',
                    numberStored: ''
                };
                this.handleNumberPress = this.handleNumberPress.bind(this);
                this.handleFunctionPress = this.handleFunctionPress.bind(this);
            }

            handleNumberPress({currentTarget}) {
                console.log(currentTarget.value);

                if(this.state.numberDisplayed === '0') {
                    if(currentTarget.value === '0') {
                    } else if(currentTarget.value === 'decimal') {
                        if (this.state.numberDisplayed.includes('.')) {
                        } else {
                            let num = this.state.numberDisplayed + '.';
                            this.setState(
                                {numberDisplayed: num}
                            )
                        }
                    } else {
                        this.setState(
                            {numberDisplayed: currentTarget.value}
                        )
                    }
                } else if(currentTarget.value === 'decimal') {
                    if (this.state.numberDisplayed.includes('.')) {
                    } else{
                        let num = this.state.numberDisplayed + '.';
                        this.setState(
                            {numberDisplayed: num}
                        )
                    }
                } else {
                    let num = this.state.numberDisplayed + currentTarget.value;
                    this.setState(
                        {numberDisplayed: num}
                    )
                }
            }

            handleFunctionPress({currentTarget}) {
                console.log(currentTarget.value);

                switch(currentTarget.value) {
                    case 'clear':
                        this.setState(
                            {numberDisplayed: '0'}
                        );
                        break;
                    case 'sign':
                        let sign = this.state.numberDisplayed * -1;
                        this.setState(
                            {numberDisplayed: sign}
                        );
                        break;
                    case 'add':
                    case 'subtract':
                    case 'multiply':
                    case 'divide':
                        this.setState(
                            {
                                numberStored: this.state.numberDisplayed,
                                arithmetic: currentTarget.value,
                                numberDisplayed: '0'
                            }
                        )
                        break;
                    case 'equals':
                            let total = 0;
                            if(this.state.arithmetic === 'add') {
                                total = parseFloat(this.state.numberStored) + parseFloat(this.state.numberDisplayed);
                            } else if(this.state.arithmetic === 'subtract') {
                                total = parseFloat(this.state.numberStored) - parseFloat(this.state.numberDisplayed);
                            } else if(this.state.arithmetic === 'multiply') {
                                total = parseFloat(this.state.numberStored) * parseFloat(this.state.numberDisplayed);
                            } else if(this.state.arithmetic === 'divide') {
                                total = parseFloat(this.state.numberStored) / parseFloat(this.state.numberDisplayed);
                            }
                         
                        this.setState(
                            {
                                numberDisplayed: parseFloat(total.toFixed(4)).toString(),
                                arithmetic: '',
                                numberStored: ''
                            }
                        )
                        break;
                }
            }

            render() {
                return (
                    <div id="container">
                        <Display numberDisplayed={this.state.numberDisplayed}/>
                        <Button handleFunctionPress={this.handleFunctionPress} handleNumberPress={this.handleNumberPress}/>
                    </div>
            )
            }
        }

        ReactDOM.render(
            <Calculator />, document.getElementById('root')
        );

    </script>
    <!--
      Note: this page is a great way to try React but it's not suitable for production.
      It slowly compiles JSX with Babel in the browser and uses a large development build of React.

      To set up a production-ready React build environment, follow these instructions:
      * https://reactjs.org/docs/add-react-to-a-new-app.html
      * https://reactjs.org/docs/add-react-to-an-existing-app.html

      You can also use React without JSX, in which case you can remove Babel:
      * https://reactjs.org/docs/react-without-jsx.html
      * https://reactjs.org/docs/cdn-links.html
    -->
  </body>
</html>